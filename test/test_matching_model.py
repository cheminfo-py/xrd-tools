import numpy as np
from xrd_tools.matching_model import run_matching

TEST_X = np.linspace(0, 70, 400)
TEST_Y = np.array(
    [
        [
            8.85182380e-05,
            -1.19281001e-03,
            1.15733920e-03,
            -6.36947516e-05,
            5.55894047e-04,
            7.64371245e-04,
            -7.09123269e-04,
            3.12225311e-04,
            -5.29872428e-04,
            8.56991857e-04,
            8.83862842e-04,
            1.12349936e-03,
            1.14034396e-03,
            -9.94002796e-04,
            -6.88860950e-04,
            -9.78643075e-04,
            9.39298130e-04,
            3.55512311e-04,
            4.05155035e-04,
            -3.61608167e-04,
            -9.12487507e-04,
            1.24743470e-04,
            1.30160872e-04,
            7.67640187e-04,
            1.15337770e-03,
            9.71827190e-04,
            -1.43419325e-04,
            -2.22190662e-04,
            1.14240462e-03,
            -2.13410603e-04,
            1.17158087e-03,
            -7.04463746e-04,
            8.46389230e-05,
            -4.93076630e-04,
            -4.46515100e-04,
            3.46842535e-05,
            6.55026350e-04,
            -1.02779668e-04,
            6.19923172e-04,
            -4.54391236e-04,
            -5.34751569e-04,
            1.19270547e-03,
            4.19409480e-04,
            -4.86957695e-04,
            -1.14949711e-03,
            -1.08551071e-03,
            -1.19547956e-04,
            -4.68019483e-04,
            -1.05401676e-03,
            7.74814456e-04,
            1.50299445e-02,
            1.28641605e-01,
            5.11535108e-01,
            1.00000000e00,
            9.75644290e-01,
            5.65180302e-01,
            5.29445708e-01,
            7.99233854e-01,
            7.17127800e-01,
            3.20800632e-01,
            6.98562190e-02,
            6.78758649e-03,
            4.28511965e-04,
            2.74637551e-03,
            1.30086746e-02,
            3.30926925e-02,
            4.20045257e-02,
            2.87075583e-02,
            1.81578696e-02,
            2.57076137e-02,
            4.01312150e-02,
            6.56138808e-02,
            1.42333359e-01,
            2.01974809e-01,
            1.50329977e-01,
            5.55698611e-02,
            1.11106392e-02,
            4.38004878e-04,
            7.34569505e-04,
            1.28916581e-03,
            -1.15831825e-03,
            4.37445007e-04,
            -1.26908533e-03,
            -3.96412273e-04,
            4.20533295e-04,
            -5.52292389e-04,
            -1.21791509e-03,
            2.07492449e-05,
            7.92518817e-03,
            3.35979760e-02,
            6.04277365e-02,
            5.59045821e-02,
            2.80228034e-02,
            1.84132922e-02,
            4.04864065e-02,
            9.78087112e-02,
            2.38007471e-01,
            4.03792024e-01,
            3.67656767e-01,
            1.65880382e-01,
            3.75439040e-02,
            3.12263076e-03,
            -1.11108806e-04,
            1.24116009e-03,
            4.98028239e-03,
            1.82613414e-02,
            4.02253121e-02,
            5.83713464e-02,
            4.66070734e-02,
            1.82523541e-02,
            3.64193623e-03,
            8.69439449e-04,
            1.89386250e-04,
            6.71911694e-04,
            7.32569082e-04,
            -1.40657343e-04,
            4.17685224e-04,
            1.05624879e-03,
            -2.02080759e-04,
            5.03366464e-04,
            7.04142556e-04,
            1.77408231e-03,
            8.62949342e-03,
            3.32427546e-02,
            7.13062286e-02,
            8.64433050e-02,
            5.86009435e-02,
            2.10366901e-02,
            4.18517599e-03,
            2.91812187e-03,
            1.69773884e-02,
            7.47732818e-02,
            1.79440513e-01,
            2.37627774e-01,
            1.72133312e-01,
            6.69379756e-02,
            1.59551483e-02,
            1.28768757e-02,
            5.95286712e-02,
            2.11326838e-01,
            4.73349988e-01,
            6.29885435e-01,
            4.63231742e-01,
            1.79411247e-01,
            3.67419198e-02,
            1.08522270e-02,
            2.68756524e-02,
            6.12572283e-02,
            8.67127851e-02,
            6.98017627e-02,
            3.27187851e-02,
            1.88548304e-02,
            3.79118212e-02,
            6.42662570e-02,
            5.96654564e-02,
            3.27098481e-02,
            1.45872552e-02,
            1.64070986e-02,
            4.11962643e-02,
            6.11841604e-02,
            7.14221075e-02,
            1.03412174e-01,
            1.22318782e-01,
            9.22369957e-02,
            4.62369882e-02,
            1.37972813e-02,
            2.04694201e-03,
            4.86114877e-04,
            1.16025982e-03,
            2.72541447e-03,
            1.17980456e-02,
            2.07986645e-02,
            3.39866132e-02,
            4.56589423e-02,
            5.01636975e-02,
            4.05912325e-02,
            3.39563005e-02,
            3.51670980e-02,
            2.85324901e-02,
            1.15946606e-02,
            2.47524236e-03,
            6.28146809e-03,
            1.10872639e-02,
            1.09437276e-02,
            7.49988109e-03,
            1.48481326e-02,
            2.92997733e-02,
            3.75327691e-02,
            3.60391587e-02,
            3.15637104e-02,
            2.86641959e-02,
            2.24625990e-02,
            1.45986099e-02,
            1.38893733e-02,
            1.13308998e-02,
            7.53609231e-03,
            2.00832216e-03,
            8.78423045e-04,
            2.40088650e-03,
            8.10330082e-03,
            1.38618331e-02,
            1.77708976e-02,
            3.42457965e-02,
            6.15370721e-02,
            9.39472839e-02,
            1.01139851e-01,
            6.13682680e-02,
            1.97251365e-02,
            7.17353914e-03,
            9.37633310e-03,
            1.15655037e-02,
            1.07316198e-02,
            1.12541541e-02,
            1.22404648e-02,
            1.36743616e-02,
            1.65356696e-02,
            2.25124415e-02,
            3.45785581e-02,
            3.01778205e-02,
            1.85729135e-02,
            1.32297063e-02,
            1.73153449e-02,
            2.92052329e-02,
            4.05919999e-02,
            3.58426087e-02,
            1.72339305e-02,
            7.80392811e-03,
            7.61027541e-03,
            1.08018061e-02,
            1.49353649e-02,
            2.57582255e-02,
            4.13310975e-02,
            3.50936837e-02,
            1.92422178e-02,
            1.17757581e-02,
            1.59959365e-02,
            1.80193856e-02,
            1.24612460e-02,
            6.59948122e-03,
            2.32421164e-03,
            7.75632565e-04,
            5.26129222e-03,
            1.35444617e-02,
            2.58032121e-02,
            2.82657463e-02,
            1.93413850e-02,
            1.24155208e-02,
            1.72919948e-02,
            2.65623461e-02,
            2.33666319e-02,
            1.44508900e-02,
            6.84738858e-03,
            4.35002660e-03,
            7.89019745e-03,
            2.07243823e-02,
            2.89631076e-02,
            3.33003849e-02,
            3.36413682e-02,
            3.21227424e-02,
            2.20424496e-02,
            1.51314978e-02,
            2.07646191e-02,
            2.97217630e-02,
            2.79691815e-02,
            1.99947078e-02,
            1.24711180e-02,
            5.68106398e-03,
            7.10239285e-04,
            -3.97628573e-05,
            3.84377199e-04,
            -1.05900946e-03,
            9.27155663e-04,
            -2.78312858e-04,
            1.14049192e-03,
            3.85961588e-03,
            1.01388423e-02,
            1.88158248e-02,
            1.71385929e-02,
            1.15432898e-02,
            2.22138688e-03,
            1.13797130e-03,
            -1.03842339e-03,
            -3.81919992e-04,
            -7.22188153e-04,
            -1.00561697e-03,
            -2.85345071e-04,
            3.96958785e-03,
            8.79076030e-03,
            1.17022451e-02,
            7.21618207e-03,
            2.78249243e-03,
            1.44073972e-03,
            2.64768465e-03,
            1.03173302e-02,
            1.80563871e-02,
            1.81284826e-02,
            9.72149614e-03,
            1.90077885e-03,
            -6.04069035e-04,
            -1.18248211e-03,
            -1.70640429e-04,
            4.19287710e-04,
            1.20518054e-03,
            7.91388040e-04,
            -1.11269928e-03,
            9.83609425e-06,
            -2.00017690e-04,
            -6.37199322e-04,
            1.12682662e-03,
            1.16528117e-03,
            2.30552256e-03,
            8.15857202e-03,
            1.12086702e-02,
            6.51723659e-03,
            3.91551340e-03,
            6.24751672e-04,
            9.37181350e-04,
            -1.39502037e-04,
            3.51771771e-04,
            -2.03484713e-04,
            -6.20506587e-04,
            -5.22517716e-04,
            1.28032197e-03,
            -6.58782839e-04,
            -8.67776398e-04,
            -1.10918260e-03,
            7.41723576e-04,
            3.89679248e-04,
            1.04846945e-03,
            7.60595605e-04,
            1.05056621e-03,
            -1.91750714e-05,
            -1.03006656e-04,
            -9.22122621e-04,
            1.89356666e-04,
            -8.75065161e-04,
            6.93255686e-04,
            4.41162352e-04,
            6.65776664e-04,
            -1.07709540e-03,
            1.94970053e-04,
            -1.62135708e-04,
            7.84584496e-04,
            -3.33678647e-04,
            -3.41582709e-05,
            -1.20228250e-03,
            -4.75028617e-04,
            1.44822436e-04,
            8.13498453e-04,
            -9.45305510e-04,
            5.07146702e-04,
            -1.39101408e-04,
            7.39136885e-04,
            3.36034951e-04,
            7.83032388e-04,
            9.31448478e-04,
            4.07219661e-04,
            7.56928115e-04,
            9.40841346e-05,
            1.28059101e-03,
            9.35149961e-04,
            -1.05038495e-03,
            7.97879591e-04,
            -1.22271315e-03,
            7.34348374e-04,
            -1.24114013e-04,
            -9.81574412e-04,
            8.95795296e-04,
            -4.90390812e-04,
            -1.09567796e-03,
            6.98629941e-04,
            6.06596062e-04,
            1.21694477e-03,
            -5.29267767e-04,
            -1.19213515e-03,
            -9.25971835e-04,
            4.20027791e-04,
            4.65271907e-04,
            -5.42856869e-04,
            2.03998512e-04,
            1.03898870e-03,
            2.66267685e-04,
            -3.98720265e-04,
            -1.12019852e-03,
            1.12429098e-03,
            1.00241159e-04,
            5.04175667e-04,
            -5.37846703e-04,
            -8.75310332e-04,
            -1.28997746e-03,
            -5.59289416e-04,
            3.14745062e-04,
            -1.21830241e-03,
            -8.42461304e-04,
            5.50344237e-04,
            -5.12011000e-04,
            1.27213052e-03,
            7.24873607e-05,
            8.50839366e-04,
            -4.35200054e-04,
        ]
    ]
)

def test_run_matching():
    match_result = run_matching(TEST_X, TEST_Y)
    assert match_result[0] == "TUJCIM"